<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Hello AngularJS</title>
    <link rel="stylesheet" href="/springDBProject/css/list.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.7.8/angular.js" charset="UTF-8"></script>

    <script type="text/javascript" src="/springDBProject/js/VirtualTable.js" charset="UTF-8"></script>
    <script type="text/javascript" src="/springDBProject/js/hello.js" charset="UTF-8"></script>
</head>

<body ng-app="myApp" ng-controller="myAppController">
    <table>
        <tr>
            <td>
                <select ng-model="tableCBox" ng-options="table.name for table in tables" ng-change="findAll()"></select>
            </td>
            <td>
                <input class="{{idInputStyle}}" type="number" placeholder="type id of record" ng-model="id" ng-change="idFieldChanged()">
            </td>
            <td>
                <button ng-click="findById()">findById</button>
            </td>
            <td>
                <button ng-click="addRecordClickHandler()">addRecord</button>
            </td>
        </tr>
    </table>

    <table id="mainTable">
        <tr>
            <th ng-repeat="header in virtualTab.columns">{{header}}</th>
        </tr>
        <tr ng-repeat="record in virtualTab.records">
            <td ng-repeat="column in virtualTab.columns">
                <p ng-model="paragraphValue" ng-click="virtualTab.setTableValue(record,column,true)" ng-if="virtualTab.getTableValue(record,column)==false">
                    {{processContent(record[column])}}</p>
                <table ng-if="virtualTab.getTableValue(record,column)">
                    <tr>
                        <td colspan="2">
                            <input type="{{virtualTab.getInputType(column)}}" ng-model="updateInputValue.value" ng-if="virtualTab.isEditedNormalColumn(record,column)" value="updateInputValue.value">
                            <select ng-model="updateInputValue.value" ng-if="virtualTab.idEditedForeignColumn(record,column)" ng-options="processContent(foreignRecord) for foreignRecord in virtualTab.getForeignColumnRecords(column)">
							</select>
                        </td>
                    </tr>
                    <tr>
                        <td><button ng-click="undoAction()">Undo</button></td>
                        <td><button ng-click="updateValueHandler()">Accept</button></td>
                    </tr>
                </table>
            </td>
        </tr>

        <tr ng-if="virtualTab.wasNewRecordAdded">
            <td ng-repeat="column in virtualTab.columns">
                <p ng-if="virtualTab.isIdColumn(column)">*</p>
                <input ng-model="recordSB[column]" class="{{recordSBStyle[$index]}}" type="{{virtualTab.getInputType(column)}}" ng-if="virtualTab.isNotIdAndForeignColumn(column)" ng-change="inputChanged($index,column,false)">
                <select ng-model="recordSB[column]" class="{{recordSBStyle[$index]}}" ng-if="virtualTab.isNotIdAndNormalColumn(column)" ng-options="processContent(foreignRecord) for foreignRecord in virtualTab.getForeignColumnRecords(column)" ng-change="inputChanged($index,column, true)">
				</select>
            </td>
        </tr>
        <tr ng-if="virtualTab.wasNewRecordAdded">
            <td colspan="{{virtualTab.columnCount}}">
                <button ng-click="undoSaveAction()">Undo</button>
                <button ng-click="saveRecordHandler()">Save Record in DB</button>
            </td>
        </tr>
    </table>
</body>

</html>